@using System.Text.Json
@inject ICategoryService CategoryService
@implements IDisposable
<MudNavMenu>
    <MudNavLink Icon="@Icons.Outlined.Home" Href="/" Match="NavLinkMatch.All">Home</MudNavLink>


    @foreach (var category in CategoryService.Categories)
    {

        var json = JsonSerializer.Serialize(Icons.Filled);
        var dict = JsonSerializer.Deserialize<Dictionary<string, string>>(json);
        var icon = dict[category.Icon];
        <MudNavLink Icon="@icon" Href=@category.Url Match="NavLinkMatch.All">@category.Name</MudNavLink>
    }
</MudNavMenu>

@code {
    protected override async Task OnInitializedAsync()
    {
        CategoryService.OnChange += StateHasChanged;
        await CategoryService.GetCategories();
    }

    public void Dispose()
    {
        CategoryService.OnChange -= StateHasChanged;
    }
}